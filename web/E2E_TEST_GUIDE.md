# 前端端到端测试指南

## 概述

本文档描述了智能校园失物招领平台前端的端到端测试方案和测试用例。

## 测试环境准备

### 1. 安装测试依赖

```bash
cd web
npm install -D cypress @cypress/vue vitest @vue/test-utils
```

### 2. 配置Cypress

创建 `cypress.config.ts`:

```typescript
import { defineConfig } from 'cypress'

export default defineConfig({
  e2e: {
    baseUrl: 'http://localhost:5173',
    supportFile: 'cypress/support/e2e.ts',
    specPattern: 'cypress/e2e/**/*.cy.{js,jsx,ts,tsx}',
  },
  component: {
    devServer: {
      framework: 'vue',
      bundler: 'vite',
    },
  },
})
```

## 测试用例清单

### 1. 用户注册登录流程

| 测试ID | 测试名称 | 测试步骤 | 预期结果 |
|--------|----------|----------|----------|
| E2E-001 | 用户注册成功 | 1. 访问注册页面<br>2. 填写学号、姓名、手机号、密码<br>3. 点击注册按钮 | 注册成功，跳转到登录页面 |
| E2E-002 | 重复学号注册失败 | 1. 使用已存在的学号注册 | 显示"学号已存在"错误提示 |
| E2E-003 | 用户登录成功 | 1. 访问登录页面<br>2. 输入正确的学号和密码<br>3. 点击登录按钮 | 登录成功，跳转到首页 |
| E2E-004 | 错误密码登录失败 | 1. 输入错误的密码登录 | 显示"密码错误"提示 |
| E2E-005 | 登录状态保持 | 1. 登录后刷新页面 | 保持登录状态 |

### 2. 物品发布流程

| 测试ID | 测试名称 | 测试步骤 | 预期结果 |
|--------|----------|----------|----------|
| E2E-010 | 发布招领信息 | 1. 登录后点击发布按钮<br>2. 选择"招领"类型<br>3. 填写标题、描述、上传图片<br>4. 选择地点<br>5. 提交 | 发布成功，跳转到详情页 |
| E2E-011 | 发布失物信息 | 1. 选择"失物"类型发布 | 发布成功 |
| E2E-012 | 编辑物品信息 | 1. 进入自己发布的物品详情<br>2. 点击编辑<br>3. 修改信息并保存 | 修改成功 |
| E2E-013 | 删除物品信息 | 1. 进入自己发布的物品详情<br>2. 点击删除<br>3. 确认删除 | 删除成功，物品不再显示 |

### 3. 搜索筛选功能

| 测试ID | 测试名称 | 测试步骤 | 预期结果 |
|--------|----------|----------|----------|
| E2E-020 | 关键词搜索 | 1. 在搜索框输入关键词<br>2. 点击搜索 | 显示包含关键词的物品 |
| E2E-021 | 类型筛选 | 1. 选择"失物"或"招领"筛选 | 只显示对应类型的物品 |
| E2E-022 | 类别筛选 | 1. 选择物品类别筛选 | 只显示对应类别的物品 |
| E2E-023 | 地图查看 | 1. 切换到地图视图 | 在地图上显示物品位置标记 |
| E2E-024 | 附近物品 | 1. 允许位置权限<br>2. 查看附近物品 | 显示附近范围内的物品 |

### 4. 智能匹配功能

| 测试ID | 测试名称 | 测试步骤 | 预期结果 |
|--------|----------|----------|----------|
| E2E-030 | 查看匹配推荐 | 1. 进入物品详情页<br>2. 查看匹配推荐列表 | 显示相关度最高的匹配物品 |
| E2E-031 | 确认匹配 | 1. 点击匹配推荐中的物品<br>2. 确认匹配 | 双方物品状态更新为"已找回" |
| E2E-032 | 匹配反馈 | 1. 对匹配结果进行反馈 | 反馈提交成功 |

### 5. 消息通知功能

| 测试ID | 测试名称 | 测试步骤 | 预期结果 |
|--------|----------|----------|----------|
| E2E-040 | 查看消息列表 | 1. 点击消息图标<br>2. 查看消息列表 | 显示所有消息，按时间排序 |
| E2E-041 | 标记消息已读 | 1. 点击未读消息 | 消息标记为已读 |
| E2E-042 | 全部标记已读 | 1. 点击"全部已读"按钮 | 所有消息标记为已读 |
| E2E-043 | 实时消息推送 | 1. 保持页面打开<br>2. 触发新消息 | 实时收到消息通知 |

### 6. 积分功能

| 测试ID | 测试名称 | 测试步骤 | 预期结果 |
|--------|----------|----------|----------|
| E2E-050 | 查看积分明细 | 1. 进入积分页面 | 显示积分变动记录 |
| E2E-051 | 查看积分排行榜 | 1. 进入排行榜页面 | 显示积分排名前100的用户 |
| E2E-052 | 发布招领获得积分 | 1. 发布招领信息 | 积分增加10 |

### 7. 管理后台功能

| 测试ID | 测试名称 | 测试步骤 | 预期结果 |
|--------|----------|----------|----------|
| E2E-060 | 查看统计数据 | 1. 管理员登录<br>2. 进入管理后台 | 显示平台统计数据 |
| E2E-061 | 管理物品列表 | 1. 查看所有物品<br>2. 筛选物品 | 显示所有物品（包括已删除） |
| E2E-062 | 审核物品 | 1. 选择物品进行审核 | 审核操作成功 |
| E2E-063 | 封禁用户 | 1. 选择用户进行封禁 | 用户状态更新为封禁 |
| E2E-064 | 导出报表 | 1. 选择时间范围<br>2. 点击导出 | 下载Excel报表文件 |

## 手动测试检查清单

### 用户注册登录
- [ ] 注册页面表单验证正常
- [ ] 注册成功后跳转到登录页
- [ ] 登录成功后跳转到首页
- [ ] 登录失败显示错误提示
- [ ] 退出登录功能正常

### 物品发布
- [ ] 发布表单验证正常
- [ ] 图片上传功能正常
- [ ] 地图选点功能正常
- [ ] 发布成功后跳转到详情页
- [ ] 编辑物品功能正常
- [ ] 删除物品功能正常

### 搜索筛选
- [ ] 关键词搜索功能正常
- [ ] 类型筛选功能正常
- [ ] 类别筛选功能正常
- [ ] 分页功能正常
- [ ] 排序功能正常

### 智能匹配
- [ ] 匹配推荐列表显示正常
- [ ] 确认匹配功能正常
- [ ] 匹配反馈功能正常

### 消息通知
- [ ] 消息列表显示正常
- [ ] 未读消息数量显示正常
- [ ] 标记已读功能正常
- [ ] WebSocket实时推送正常

### 积分系统
- [ ] 积分明细显示正常
- [ ] 积分排行榜显示正常
- [ ] 积分奖励正确发放

### 管理后台
- [ ] 统计数据显示正常
- [ ] 物品管理功能正常
- [ ] 用户管理功能正常
- [ ] 数据导出功能正常

## 运行测试

### 启动开发服务器

```bash
# 启动后端
cd lostandfound
mvn spring-boot:run

# 启动前端
cd web
npm run dev
```

### 运行Cypress测试

```bash
# 打开Cypress测试界面
npx cypress open

# 或者在命令行运行
npx cypress run
```

## 测试报告

测试完成后，Cypress会生成测试报告，包括：
- 测试通过/失败统计
- 测试截图和视频
- 详细的错误信息

报告位置：`cypress/reports/`
